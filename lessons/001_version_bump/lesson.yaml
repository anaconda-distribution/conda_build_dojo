# IMPORTANT: If your lesson requires a snapshot of repodata in a certain 
# state (e.g. missing some dependencies for python-3.9), then please make
# sure the repodata is saved in the following directory structure:
#
# dojo/
#   |---- lessons/
#           |---- 001_version_bump/
#                   |---- dojo_repodata/
#                           |---- <TIMESTAMP>/
#                                   |---- linux-64/
#                                           |---- repodata.json
#                                   |---- noarch/
#                                           |---- repodata.json

# The lesson title.
title: "How to do a version bump"

# Learning objectives. 
# Each objective should help complete this sentence: 
# "By the end of this lesson, the learner will be able to..."
objectives: 
  - Build an updated version of tqdm.

# Tags.
# Learners can search for this lesson using tags entered here.
tags: ['version', 'version bump', 'update', 'update versions', 'tqdm']

# Package name and version the learner will be attempting to build.
target_package: tqdm-4.56.0

# Target platform the package will be built for.
target_platform: noarch

# URL to the feedstock (use HTTPS, not SSH, to avoid the need for a key).
feedstock_url: https://github.com/AnacondaRecipes/tqdm-feedstock.git

# The specific commit hash from the feedstock repo that should be initially 
# checked out. This acts as the starting point for the learner, a "snapshot"
# in time from which they will complete their lesson objectives.
commit: b3b1609510cc7d2c0256abd5c1266fde1ee046d5

# Indicates whether this lesson requires a modified repodata "snapshot".
# In other words, a version of defaults that's been edited to recreate the 
# starting point for the lesson.
modified_repodata: False

# Lesson prompts (or steps).
# List the propmpts/steps the learner should go through.
# You can also pose questions and answers (for example, one prompt is 
# a question, and the subsequent prompt is the answer to that question).
# BONUS: Provide hints to the learner (just tell them the hint will be 
# revealed in the next step if they want it).
prompts:
  - |
    Open this file: training_feedstocks/tqdm-feedstock/recipe/meta.yaml
    Find the current version and sha256 hash value.
  - Go to https://pypi.org/, search for "tqdm", and go to the project's page.
  - Click on "Release History". Find the next version after 4.55.2, and click on it.
  - You should now be on the page for "tqdm 4.56.0". Click on "Download files".
  - |
    We build conda pacakges from source files (e.g. .tar.gz, .xz, or .zip). 
    On the row for "tqdm-4.56.0.tar.gz", click on the "View" button.
    Click the "Copy" button on the row for "SHA256".
  - |
    Go back to the meta.yaml. 
    Update the version number to "4.56.0", and paste in the new sha256 value.
  - |
    Build the package: 

      conda-build <PATH TO RECIPE>
  - |
    You should get an error like this during the test step of the build:


    ___________________ ERROR collecting tests/tests_asyncio.py ____________________
    Direct construction of Function has been deprecated, please use Function.from_parent.
    See https://docs.pytest.org/en/stable/deprecations.html#node-construction-changed-to-node-from-parent for more details.


    You can ignore this for now. Just re-run the command with the "--no-test" argument.

        conda-build <PATH TO RECIPE> --no-test
